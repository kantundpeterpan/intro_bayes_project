# install.packages(c("readr","coda","runjags","MCMCvis","ggmcmc","basicMCMCplots"))
# install.packages(c("igraph", "pracma", "numDeriv", "R6"))
library(tidyverse)
# install.packages(c("readr","coda","runjags","MCMCvis","ggmcmc","basicMCMCplots"))
# install.packages(c("igraph", "pracma", "numDeriv", "R6"))
library(tidyverse)
library(R2OpenBUGS)
library(rjags)
library(nimble)
## rebuild data
dat <- matrix(c(380, 419,
632, 673,
28, 34,
363, 396,
527, 576,
36, 50,
282, 332,
514, 548,
16, 34,
446, 490,
588, 628,
28, 39,
400, 441,
27, 32), nrow = 14, byrow = TRUE)
dat <- as.data.frame(dat)
dat[,2] <- dat[,2] - dat[,1]
# dimnames(dat) <- list(c("North Carolina", "Georgia", "Wisconsin", "Florida", "Mississippi"))
geography <- rep(c("North Carolina", "Georgia", "Wisconsin", "Florida", "Mississippi"), each = 3)
geography <- geography[-length(geography)]
insurance <- rep(c("Any Medicaid", "Private Insurance Only", "Uninsured"), 5)
# remove row: Missisippi has no Any Mediaid data
insurance <- insurance[-13]
dat <- cbind(geography, insurance, dat)
names(dat) <- c("geography", "insurance", "yes", "no")
dat$Sum <- dat$yes + dat$no
dat$geography <- as.factor(dat$geography)
dat$insurance <- as.factor(dat$insurance)
## for more details: modify dataset, create collapsed datasets
dat_margins <- cbind(rbind(ungroup(dat)[,1:2], NA), addmargins(as.matrix(dat[-(1:2)])))
# dataframes collapsed by geography and insurance
dat_geography <- dat %>% group_by(geography) %>%
summarize(yes = sum(yes),
no = sum(no),
sum = sum(Sum))
totN <- 4692
dat_geo_prob <- dat_geography %>% mutate(across(where(is.numeric), ~ .x / totN))
dat_insurance <- dat %>% group_by(insurance) %>%
summarize(yes = sum(yes),
no = sum(no),
sum = sum(Sum))
dat_ins_prob <- dat_insurance %>% mutate(across(where(is.numeric), ~ .x / totN))
?plogis
x <- c(6, 48, 31, 32, 43, 68, 57, 42, 61, 55, 38, 47)
sd(x)
x <- c(46, 48, 31, 32, 43, 68, 57, 42, 61, 55, 38, 47)
sd(x)
((46-))
m <- mean(x)
((46-m)^2+(48-m)^2+(31-m)^2+(32-m)^2+(43-m)^2+(68-m)^2+(57-m)^2+(42-m)^2+(61-m)^2+(55-m)^2+(38-m)^2+(47-m)^2)
((46-m)^2+(48-m)^2+(31-m)^2+(32-m)^2+(43-m)^2+(68-m)^2+(57-m)^2+(42-m)^2+(61-m)^2+(55-m)^2+(38-m)^2+(47-m)^2) / 11
var <- 127.697
sqrt(var)
